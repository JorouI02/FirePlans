<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä ‚Äî –°–∏–ª–∏ –∏ –°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞ –ì–∞—Å–µ–Ω–µ</title>
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d1117;
    --bg2: #161b22;
    --bg3: #1c2330;
    --border: #2d3748;
    --accent: #e05c2a;
    --accent2: #f08040;
    --accent-dim: rgba(224,92,42,0.15);
    --text: #e6edf3;
    --text-muted: #8b949e;
    --text-dim: #6e7681;
    --green: #3fb950;
    --blue: #58a6ff;
    --yellow: #d29922;
    --red: #f85149;
    --radius: 8px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Source Sans 3', sans-serif;
    font-size: 15px;
    min-height: 100vh;
    background-image:
      radial-gradient(ellipse 80% 50% at 50% -20%, rgba(224,92,42,0.08), transparent),
      repeating-linear-gradient(0deg, transparent, transparent 59px, rgba(255,255,255,0.015) 60px),
      repeating-linear-gradient(90deg, transparent, transparent 59px, rgba(255,255,255,0.015) 60px);
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    border-bottom: 1px solid var(--border);
    padding: 18px 32px;
    display: flex; align-items: center; gap: 14px;
    background: rgba(13,17,23,0.9);
    position: sticky; top: 0; z-index: 100;
    backdrop-filter: blur(8px);
  }
  .logo-icon {
    width: 38px; height: 38px;
    background: var(--accent);
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; flex-shrink: 0;
  }
  header h1 {
    font-family: 'Rajdhani', sans-serif;
    font-size: 20px; font-weight: 700; letter-spacing: 0.5px;
    color: var(--text);
  }
  header span { color: var(--accent); }

  /* ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ */
  .progress-wrap {
    padding: 24px 32px 0;
    max-width: 860px; margin: 0 auto;
  }
  .progress-steps {
    display: flex; gap: 0; position: relative;
  }
  .progress-steps::before {
    content: '';
    position: absolute; top: 16px; left: 0; right: 0; height: 2px;
    background: var(--border);
    z-index: 0;
  }
  .progress-bar-fill {
    position: absolute; top: 16px; left: 0; height: 2px;
    background: var(--accent);
    transition: width 0.4s ease;
    z-index: 1;
  }
  .step-dot {
    flex: 1; display: flex; flex-direction: column; align-items: center;
    gap: 8px; position: relative; z-index: 2; cursor: pointer;
  }
  .step-dot .dot {
    width: 32px; height: 32px; border-radius: 50%;
    background: var(--bg2); border: 2px solid var(--border);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Rajdhani', sans-serif; font-weight: 700; font-size: 13px;
    color: var(--text-muted);
    transition: all 0.3s;
  }
  .step-dot.active .dot {
    background: var(--accent); border-color: var(--accent);
    color: #fff; box-shadow: 0 0 12px rgba(224,92,42,0.5);
  }
  .step-dot.done .dot {
    background: var(--bg2); border-color: var(--green);
    color: var(--green);
  }
  .step-dot.done .dot::after { content: '‚úì'; }
  .step-dot span {
    font-size: 11px; color: var(--text-dim); text-align: center;
    font-family: 'Rajdhani', sans-serif; font-weight: 600; letter-spacing: 0.5px;
    text-transform: uppercase;
  }
  .step-dot.active span { color: var(--accent); }

  /* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
  main {
    max-width: 860px; margin: 0 auto;
    padding: 32px 32px 80px;
  }

  /* ‚îÄ‚îÄ PANEL ‚îÄ‚îÄ */
  .panel {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 32px;
    margin-top: 28px;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:none; } }

  .panel-title {
    font-family: 'Rajdhani', sans-serif;
    font-size: 22px; font-weight: 700;
    color: var(--text); margin-bottom: 6px;
    display: flex; align-items: center; gap: 10px;
  }
  .panel-title .badge {
    font-size: 11px; padding: 3px 8px;
    background: var(--accent-dim); color: var(--accent);
    border: 1px solid rgba(224,92,42,0.3);
    border-radius: 20px; font-weight: 600; letter-spacing: 1px;
  }
  .panel-sub {
    color: var(--text-muted); font-size: 13px; margin-bottom: 28px;
    line-height: 1.5;
  }

  /* ‚îÄ‚îÄ SCENARIO CARDS ‚îÄ‚îÄ */
  .scenario-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 14px;
  }
  .scenario-card {
    border: 2px solid var(--border);
    border-radius: var(--radius);
    padding: 20px; cursor: pointer;
    transition: all 0.25s;
    background: var(--bg3);
    position: relative; overflow: hidden;
  }
  .scenario-card::before {
    content: ''; position: absolute;
    top: 0; left: 0; right: 0; height: 3px;
    background: var(--accent); transform: scaleX(0);
    transition: transform 0.25s; transform-origin: left;
  }
  .scenario-card:hover { border-color: rgba(224,92,42,0.4); transform: translateY(-2px); }
  .scenario-card:hover::before { transform: scaleX(1); }
  .scenario-card.selected {
    border-color: var(--accent);
    background: var(--accent-dim);
  }
  .scenario-card.selected::before { transform: scaleX(1); }
  .scenario-icon { font-size: 28px; margin-bottom: 10px; }
  .scenario-name {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    font-size: 16px; color: var(--text); margin-bottom: 4px;
  }
  .scenario-desc { font-size: 12px; color: var(--text-muted); line-height: 1.4; }

  /* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
  .form-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  .form-grid.single { grid-template-columns: 1fr; }
  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group.span2 { grid-column: span 2; }

  label {
    font-size: 12px; font-weight: 600; letter-spacing: 0.5px;
    text-transform: uppercase; color: var(--text-muted);
    font-family: 'Rajdhani', sans-serif;
  }
  label .unit {
    font-weight: 400; color: var(--text-dim);
    text-transform: none; letter-spacing: 0;
  }

  input[type=number], select, input[type=text] {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 10px 14px;
    color: var(--text); font-size: 15px;
    font-family: 'Source Sans 3', sans-serif;
    transition: border-color 0.2s;
    width: 100%;
    -moz-appearance: textfield;
  }
  input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; }
  input:focus, select:focus {
    outline: none; border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(224,92,42,0.12);
  }
  select option { background: var(--bg2); }

  .hint {
    font-size: 11px; color: var(--text-dim);
    line-height: 1.4; padding: 6px 10px;
    background: rgba(255,255,255,0.03);
    border-left: 2px solid var(--border);
    border-radius: 0 4px 4px 0;
  }

  /* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
  .section-divider {
    grid-column: span 2;
    border-top: 1px solid var(--border);
    padding-top: 12px; margin-top: 4px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 13px; font-weight: 700;
    color: var(--text-dim); letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* ‚îÄ‚îÄ RESULTS ‚îÄ‚îÄ */
  .results-grid {
    display: grid; grid-template-columns: repeat(3, 1fr);
    gap: 14px; margin-bottom: 24px;
  }
  .result-card {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 16px;
    border-top: 3px solid var(--accent);
    animation: fadeIn 0.4s ease both;
  }
  .result-card:nth-child(2) { animation-delay: 0.05s; border-top-color: var(--blue); }
  .result-card:nth-child(3) { animation-delay: 0.1s; border-top-color: var(--green); }
  .result-card:nth-child(4) { animation-delay: 0.15s; border-top-color: var(--yellow); }
  .result-card:nth-child(5) { animation-delay: 0.2s; border-top-color: var(--accent2); }
  .result-card:nth-child(6) { animation-delay: 0.25s; border-top-color: var(--red); }

  .result-label {
    font-size: 11px; color: var(--text-dim);
    font-family: 'Rajdhani', sans-serif; font-weight: 600;
    text-transform: uppercase; letter-spacing: 0.5px;
    margin-bottom: 6px;
  }
  .result-value {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    font-size: 28px; color: var(--text); line-height: 1;
  }
  .result-unit {
    font-size: 13px; color: var(--text-muted); margin-top: 2px;
  }

  /* ‚îÄ‚îÄ FORMULA BOX ‚îÄ‚îÄ */
  .formula-section {
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 20px;
    margin-bottom: 20px;
  }
  .formula-title {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    font-size: 13px; color: var(--text-dim);
    text-transform: uppercase; letter-spacing: 1px;
    margin-bottom: 14px;
  }
  .formula-row {
    display: flex; justify-content: space-between; align-items: flex-start;
    padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.04);
    gap: 10px;
  }
  .formula-row:last-child { border-bottom: none; }
  .formula-desc { color: var(--text-muted); font-size: 13px; flex: 1; }
  .formula-calc {
    font-family: 'Rajdhani', sans-serif; font-weight: 600;
    font-size: 14px; color: var(--accent); white-space: nowrap;
    text-align: right;
  }

  /* ‚îÄ‚îÄ ALERT ‚îÄ‚îÄ */
  .alert {
    padding: 12px 16px; border-radius: var(--radius);
    font-size: 13px; margin-bottom: 18px;
    display: flex; gap: 10px; align-items: flex-start;
  }
  .alert-warn {
    background: rgba(210,153,34,0.1); border: 1px solid rgba(210,153,34,0.3);
    color: var(--yellow);
  }
  .alert-info {
    background: rgba(88,166,255,0.08); border: 1px solid rgba(88,166,255,0.2);
    color: var(--blue);
  }

  /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
  .btn-row {
    display: flex; gap: 12px; justify-content: flex-end;
    margin-top: 28px;
  }
  button {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    font-size: 15px; letter-spacing: 0.5px;
    padding: 11px 24px; border-radius: var(--radius);
    cursor: pointer; transition: all 0.2s; border: none;
  }
  .btn-primary {
    background: var(--accent); color: #fff;
  }
  .btn-primary:hover { background: var(--accent2); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(224,92,42,0.35); }
  .btn-secondary {
    background: transparent; color: var(--text-muted);
    border: 1px solid var(--border);
  }
  .btn-secondary:hover { border-color: var(--accent); color: var(--text); }
  .btn-success {
    background: var(--green); color: #0d1117;
  }
  .btn-success:hover { filter: brightness(1.1); }

  /* ‚îÄ‚îÄ SUMMARY TABLE ‚îÄ‚îÄ */
  .summary-table {
    width: 100%; border-collapse: collapse; margin-top: 8px;
  }
  .summary-table th {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px;
    color: var(--text-dim); padding: 8px 12px;
    border-bottom: 1px solid var(--border); text-align: left;
  }
  .summary-table td {
    padding: 10px 12px; font-size: 14px; color: var(--text);
    border-bottom: 1px solid rgba(255,255,255,0.04);
  }
  .summary-table tr:last-child td { border-bottom: none; }
  .summary-table td.num {
    font-family: 'Rajdhani', sans-serif; font-weight: 700;
    color: var(--accent); font-size: 16px;
  }

  /* ‚îÄ‚îÄ PRINT ‚îÄ‚îÄ */
  @media print {
    body { background: #fff; color: #000; }
    header, .btn-row, .progress-wrap { display: none; }
    .panel { background: #fff; border: 1px solid #ccc; }
    .result-card { background: #f9f9f9; border: 1px solid #ddd; }
    .result-value { color: #000; }
    .formula-section { background: #f9f9f9; }
    .result-label, .result-unit, .formula-desc { color: #555; }
    .result-card:nth-child(n) { border-top-color: #333; }
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 600px) {
    .scenario-grid { grid-template-columns: 1fr; }
    .form-grid { grid-template-columns: 1fr; }
    .form-group.span2 { grid-column: span 1; }
    .results-grid { grid-template-columns: 1fr 1fr; }
    main { padding: 20px 16px 60px; }
    header { padding: 14px 16px; }
    .progress-wrap { padding: 16px 16px 0; }
    .section-divider { grid-column: span 1; }
    .formula-row { flex-direction: column; gap: 4px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo-icon">üî•</div>
  <div>
    <h1>–ö–ê–õ–ö–£–õ–ê–¢–û–† <span>–ü–û–ñ–ê–†–ù–ò –°–ò–õ–ò –ò –°–†–ï–î–°–¢–í–ê</span></h1>
  </div>
</header>

<div class="progress-wrap">
  <div class="progress-steps" id="progressSteps">
    <div class="progress-bar-fill" id="progressFill" style="width:0%"></div>
    <div class="step-dot active" data-step="0"><div class="dot">1</div><span>–°—Ü–µ–Ω–∞—Ä–∏–π</span></div>
    <div class="step-dot" data-step="1"><div class="dot">2</div><span>–í—Ö–æ–¥–Ω–∏ –¥–∞–Ω–Ω–∏</span></div>
    <div class="step-dot" data-step="2"><div class="dot">3</div><span>–†–µ–∑—É–ª—Ç–∞—Ç–∏</span></div>
  </div>
</div>

<main id="mainContent"></main>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let currentStep = 0;
let selectedScenario = null;
let inputData = {};
let results = {};

const scenarios = [
  { id:'fire', icon:'üè¢', name:'–û–±–∏–∫–Ω–æ–≤–µ–Ω –ø–æ–∂–∞—Ä –≤ —Å–≥—Ä–∞–¥–∞', desc:'–ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ —Å–∏–ª–∏ –∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞ –≥–∞—Å–µ–Ω–µ –Ω–∞ –ø–æ–∂–∞—Ä –≤ —Å–≥—Ä–∞–¥–∞ ‚Äî –ø–ª–æ—â, —Ä–∞–∑—Ö–æ–¥ –Ω–∞ –≤–æ–¥–∞, —Å—Ç—Ä—É–π–Ω–∏—Ü–∏, –µ–∫–∏–ø–∏, –∞–≤—Ç–æ–º–æ–±–∏–ª–∏.' },
  { id:'tank',  icon:'üõ¢Ô∏è', name:'–†–µ–∑–µ—Ä–≤–æ–∞—Ä —Å –õ–ó–¢/–ì–¢', desc:'–í–µ—Ä—Ç–∏–∫–∞–ª–µ–Ω –º–µ—Ç–∞–ª–µ–Ω —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ–Ω —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä —Å –ª–µ—Å–Ω–æ –∏–ª–∏ –≥–æ—Ä–∏–º–æ —Ç–µ—á–Ω–æ—Å—Ç–∏ ‚Äî –æ—Ö–ª–∞–∂–¥–∞–Ω–µ –∏ –≥–∞—Å–µ–Ω–µ —Å –ø—è–Ω–∞.' },
  { id:'powder',icon:'üí®', name:'–ü—Ä–∞—Ö–æ–≤–æ –≥–∞—Å–µ–Ω–µ', desc:'–û–ø—Ä–µ–¥–µ–ª—è–Ω–µ –Ω–∞ —Å–∏–ª–∏ –∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø—Ä–∏ –≥–∞—Å–µ–Ω–µ —Å –æ–≥–Ω–µ–≥–∞—Å–∏—Ç–µ–ª–Ω–∏ –ø—Ä–∞—Ö–æ–≤–∏ —Å—ä—Å—Ç–∞–≤–∏ ‚Äî –∫–ª–∞—Å –í, –° –ø–æ–∂–∞—Ä–∏.' },
  { id:'foam',  icon:'üßØ', name:'–ü—è–Ω–∞ –≤ –ø–æ–º–µ—â–µ–Ω–∏–µ', desc:'–ì–∞—Å–µ–Ω–µ —Å –≤—ä–∑–¥—É—à–Ω–æ-–º–µ—Ö–∞–Ω–∏—á–Ω–∞ –ø—è–Ω–∞ —Å –Ω–∏—Å–∫–∞/—Å—Ä–µ–¥–Ω–∞/–≤–∏—Å–æ–∫–∞ –∫—Ä–∞—Ç–Ω–æ—Å—Ç –≤ –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏ –ø–æ–º–µ—â–µ–Ω–∏—è.' },
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function render() {
  updateProgress();
  const main = document.getElementById('mainContent');
  if (currentStep === 0) main.innerHTML = renderStep0();
  else if (currentStep === 1) main.innerHTML = renderStep1();
  else if (currentStep === 2) main.innerHTML = renderStep2();
  attachEvents();
}

function updateProgress() {
  const dots = document.querySelectorAll('.step-dot');
  const fill = document.getElementById('progressFill');
  dots.forEach((d,i) => {
    d.classList.remove('active','done');
    if(i === currentStep) d.classList.add('active');
    else if(i < currentStep) d.classList.add('done');
  });
  fill.style.width = currentStep === 0 ? '0%' : currentStep === 1 ? '50%' : '100%';
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ STEP 0: –ò–∑–±–æ—Ä –Ω–∞ —Å—Ü–µ–Ω–∞—Ä–∏–π ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderStep0() {
  return `<div class="panel">
    <div class="panel-title">–ò–∑–±–µ—Ä–µ—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π <span class="badge">–°–¢–™–ü–ö–ê 1/3</span></div>
    <div class="panel-sub">–ò–∑–±–µ—Ä–µ—Ç–µ –≤–∏–¥–∞ –Ω–∞ –ø–æ–∂–∞—Ä–∞, –∑–∞ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ –ø—Ä–∞–≤–∏–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∏ –¥–∞ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ—á–Ω–∏—Ç–µ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è.</div>
    <div class="scenario-grid">
      ${scenarios.map(s => `
        <div class="scenario-card ${selectedScenario===s.id?'selected':''}" data-id="${s.id}" onclick="selectScenario('${s.id}')">
          <div class="scenario-icon">${s.icon}</div>
          <div class="scenario-name">${s.name}</div>
          <div class="scenario-desc">${s.desc}</div>
        </div>`).join('')}
    </div>
    <div class="btn-row">
      <button class="btn-primary" onclick="goToStep(1)" ${!selectedScenario?'disabled':''}>–ù–∞–ø—Ä–µ–¥ ‚Üí</button>
    </div>
  </div>`;
}

function selectScenario(id) {
  selectedScenario = id;
  inputData = {};
  render();
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ STEP 1: –í—Ö–æ–¥–Ω–∏ –¥–∞–Ω–Ω–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderStep1() {
  const forms = { fire: formFire, tank: formTank, powder: formPowder, foam: formFoam };
  const s = scenarios.find(x=>x.id===selectedScenario);
  return `<div class="panel">
    <div class="panel-title">${s.icon} ${s.name} <span class="badge">–°–¢–™–ü–ö–ê 2/3</span></div>
    <div class="panel-sub">–ü–æ–ø—ä–ª–Ω–µ—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –∑–∞ –æ–±–µ–∫—Ç–∞. –ü–æ–ª–µ—Ç–∞—Ç–∞ –º–∞—Ä–∫–∏—Ä–∞–Ω–∏ —Å * —Å–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏.</div>
    ${forms[selectedScenario]()}
    <div class="btn-row">
      <button class="btn-secondary" onclick="goToStep(0)">‚Üê –ù–∞–∑–∞–¥</button>
      <button class="btn-primary" onclick="calculate()">–ò–∑—á–∏—Å–ª–∏ ‚Üí</button>
    </div>
  </div>`;
}

// ‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü–∞ 2: –ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç –ø–æ –≤–∏–¥ —Å–≥—Ä–∞–¥–∞/–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ ‚îÄ‚îÄ
const table2Data = [
  { cat:'–ñ–∏–ª–∏—â–Ω–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏ —Å–≥—Ä–∞–¥–∏', rows:[
    { name:'I‚ÄìIII —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.10' },
    { name:'IV —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.10' },
    { name:'V —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.15' },
    { name:'–ú–∞–∑–µ—Ç–∞ / –º–∞–Ω—Å–∞—Ä–¥–Ω–∏ –ø–æ–º–µ—â–µ–Ω–∏—è', val:'0.15' },
  ]},
  { cat:'–ñ–∏–≤–æ—Ç–Ω–æ–≤—ä–¥–Ω–∏ —Å–≥—Ä–∞–¥–∏', rows:[
    { name:'I‚ÄìIII —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.10' },
    { name:'IV —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.15' },
    { name:'V —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.20' },
  ]},
  { cat:'–ö—É–ª—Ç—É—Ä–Ω–æ-–∑—Ä–µ–ª–∏—â–Ω–∏ (—Ç–µ–∞—Ç—Ä–∏, –∫–∏–Ω–æ)', rows:[
    { name:'–°—Ü–µ–Ω–∞', val:'0.20' },
    { name:'–ó—Ä–∏—Ç–µ–ª–Ω–∞ –∑–∞–ª–∞', val:'0.15' },
    { name:'–î—Ä—É–≥–∏ –ø–æ–º–µ—â–µ–Ω–∏—è', val:'0.15' },
  ]},
  { cat:'–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è', rows:[
    { name:'I‚ÄìII —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.15' },
    { name:'III —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.20' },
    { name:'IV‚ÄìV —Å—Ç. –Ω–∞ –æ–≥–Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç', val:'0.25' },
    { name:'–ú–∞–∑–µ—Ç–∞', val:'0.30' },
    { name:'–¢–∞–≤–∞–Ω—Å–∫–∏ –ø–æ–º–µ—â–µ–Ω–∏—è', val:'0.15' },
    { name:'–ë–æ—è–¥–∂–∏–π—Å–∫–∏ —Ü–µ—Ö–æ–≤–µ', val:'0.20' },
    { name:'–î—ä—Ä–≤–æ–æ–±—Ä–∞–±–æ—Ç–≤–∞—â–∏ —Ü–µ—Ö–æ–≤–µ', val:'0.10‚Äì0.25' },
    { name:'–¶–µ—Ö–æ–≤–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∏–ª–Ω–æ—Ç–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', val:'0.10‚Äì0.15' },
    { name:'–ú–µ–ª–Ω–∏—Ü–∏ –∏ –µ–ª–µ–≤–∞—Ç–æ—Ä–∏', val:'0.14' },
  ]},
  { cat:'–ì–æ—Ä–∏–º–∏ –ø–æ–∫—Ä–∏–≤–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–∏ —Å–≥—Ä–∞–¥–∏)', rows:[
    { name:'–ì–∞—Å–µ–Ω–µ –æ—Ç –≤—ä—Ç—Ä–µ', val:'0.15' },
    { name:'–ì–∞—Å–µ–Ω–µ –æ—Ç –≤—ä–Ω (–æ—Ç –ø–æ–∫—Ä–∏–≤–∞)', val:'0.08' },
    { name:'–†–∞–∑–≤–∏–ª —Å–µ –ø–æ–∂–∞—Ä', val:'0.15' },
  ]},
  { cat:'–°–ø–µ—Ü–∏–∞–ª–Ω–∏ –æ–±–µ–∫—Ç–∏', rows:[
    { name:'–¢—ä—Ä–≥–æ–≤—Å–∫–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è / —Å–∫–ª–∞–¥–æ–≤–µ', val:'0.20' },
    { name:'–•–ª–∞–¥–∏–ª–Ω–∏—Ü–∏', val:'0.10' },
    { name:'–°—Ç—Ä–æ—è—â–∏ —Å–µ —Å–≥—Ä–∞–¥–∏', val:'0.10' },
    { name:'–ï–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏–∏ ‚Äî –º–∞—à–∏–Ω–Ω–∏ –∑–∞–ª–∏', val:'0.20' },
  ]},
];

// ‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü–∞ 3 (–∏–∑–≤–∞–¥–∫–∞): –õ–∏–Ω–µ–π–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç –Ω–∞ –∏–∑–≥–∞—Ä—è–Ω–µ ‚îÄ‚îÄ
const table3Data = [
  { name:'–•–∞—Ä—Ç–∏—è —Ä–∞–∑–ø—Ä—ä—Å–Ω–∞—Ç–∞', vl:'0.6‚Äì1.0', In:'‚Äî' },
  { name:'–î—ä—Ä–≤–µ—Å–∏–Ω–∞ (–∏–∑–¥–µ–ª–∏—è, W 8‚Äì10%)', vl:'1.0‚Äì1.1', In:'‚Äî' },
  { name:'–î—ä—Ä–≤–µ—Å–∏–Ω–∞ (—Ä–∞–∫–ª–∏ –æ—Ç –¥—ä—Å–∫–∏)', vl:'3.0‚Äì5.6', In:'‚Äî' },
  { name:'–¢–µ–∫—Å—Ç–∏–ª–Ω–∏ –∏–∑–¥–µ–ª–∏—è', vl:'0.6‚Äì1.0', In:'‚Äî' },
  { name:'–ì—É–º–µ–Ω–∏ –∏–∑–¥–µ–ª–∏—è –Ω–∞ –æ—Ç–∫—Ä–∏—Ç–æ', vl:'1.0‚Äì1.5', In:'‚Äî' },
  { name:'–•–∞—Ä—Ç–∏—è –Ω–∞ —Ä—É–ª–∞', vl:'1.2', In:'‚Äî' },
  { name:'–°–∏–Ω—Ç–µ—Ç–∏—á–µ–Ω –∫–∞—É—á—É–∫', vl:'1.6', In:'‚Äî' },
  { name:'–õ–µ–Ω–µ–Ω–∏ / –∫–æ–Ω–æ–ø–µ–Ω–∏ –≤–ª–∞–∫–Ω–∞', vl:'0.5‚Äì0.7', In:'‚Äî' },
  { name:'–ü–µ–Ω–æ–ø–æ–ª–∏—É—Ä–µ—Ç–∞–Ω (–¥—É–Ω–∞–ø—Ä–µ–Ω)', vl:'0.75‚Äì0.9', In:'‚Äî' },
  { name:'–¢–µ–∫—Å—Ç–∏–ª–Ω–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (—Ü–µ—Ö–æ–≤–µ)', vl:'0.35‚Äì0.65', In:'‚Äî' },
  { name:'–î—ä—Ä–≤–æ–æ–±—Ä–∞–±–æ—Ç–≤–∞—â–∏ (—Å—É—à–∏–ª–Ω–∏, –≥–∞—Ç–µ—Ä–∏)', vl:'2.0‚Äì2.5', In:'‚Äî' },
  { name:'–î—ä—Ä–≤–æ–æ–±—Ä–∞–±–æ—Ç–≤–∞—â–∏ (—Ü–µ—Ö–æ–≤–µ)', vl:'0.8‚Äì1.2', In:'‚Äî' },
  { name:'–°–∫–ª–∞–¥–æ–≤–µ –∑–∞ –¥—ä—Ä–≤–µ—Å–∏–Ω–∞', vl:'1.0‚Äì1.5', In:'‚Äî' },
  { name:'–ì–æ—Ä—Å–∫–∏ –Ω–∞—Å–∞–∂–¥–µ–Ω–∏—è', vl:'0.1‚Äì0.25', In:'‚Äî' },
  { name:'–ì–æ—Ä–∏–º–∏ –ø—Ä–µ–≥—Ä–∞–¥–∏ –∏ –º–µ–±–µ–ª–∏', vl:'0.3‚Äì0.4', In:'‚Äî' },
  { name:'–ñ–∏–≤–æ—Ç–Ω–æ–≤—ä–¥–Ω–∏ —Ñ–µ—Ä–º–∏ (–ø–æ –ø–æ—Å—Ç–µ–ª—è—Ç–∞)', vl:'0.15‚Äì0.35', In:'‚Äî' },
  { name:'–ö–∞–±–µ–ª–Ω–∏ —Ç—É–Ω–µ–ª–∏ (–±–µ–∑ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ)', vl:'0.5‚Äì0.7', In:'‚Äî' },
  { name:'–ö–∞–±–µ–ª–∏ –ø–æ–¥ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ', vl:'30‚Äì70', In:'‚Äî' },
];

function formFire() {
  const t2rows = table2Data.map(cat => `
    <tr><td colspan="2" style="background:rgba(224,92,42,0.08);color:var(--accent);font-family:'Rajdhani',sans-serif;font-weight:700;font-size:12px;letter-spacing:0.5px;padding:6px 10px;">${cat.cat}</td></tr>
    ${cat.rows.map(r => `<tr onclick="setIntenzivnost('${r.val}')" style="cursor:pointer">
      <td style="padding:5px 10px;font-size:13px;color:var(--text)">${r.name}</td>
      <td style="padding:5px 10px;font-family:'Rajdhani',sans-serif;font-weight:700;color:var(--blue);text-align:right">${r.val}</td>
    </tr>`).join('')}
  `).join('');

  const t3rows = table3Data.map(r => `
    <tr onclick="setVl('${r.vl}')" style="cursor:pointer">
      <td style="padding:5px 10px;font-size:13px;color:var(--text)">${r.name}</td>
      <td style="padding:5px 10px;font-family:'Rajdhani',sans-serif;font-weight:700;color:var(--green);text-align:right">${r.vl}</td>
    </tr>
  `).join('');

  return `<div class="form-grid">
    <div class="section-divider">‚ñ∂ –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–∞ –ø–æ–∂–∞—Ä–∞</div>
    <div class="form-group">
      <label>–§–æ—Ä–º–∞ –Ω–∞ –ø–æ–∂–∞—Ä–∞ *</label>
      <select id="fireShape">
        <option value="round">–ö—Ä—ä–≥–æ–≤–∞</option>
        <option value="rect">–ü—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∞</option>
        <option value="semicircle">–ü–æ–ª—É–∫—Ä—ä–≥–æ–≤–∞</option>
        <option value="sector">–°–µ–∫—Ç–æ—Ä–Ω–∞</option>
      </select>
    </div>
    <div class="form-group">
      <label>–ù–∞—á–∞–ª–æ –Ω–∞ –≥–∞—Å–µ–Ω–µ t<sub>—Å–≤</sub> <span class="unit">[min]</span></label>
      <input type="number" id="tsv" value="15" min="1" max="60" step="0.5">
      <div class="hint">–°–≤–æ–±–æ–¥–Ω–æ —Ä–∞–∑–≤–∏—Ç–∏–µ = —Ä–∞–∑–ø—Ä. + —Å—ä–æ–±—â–µ–Ω–∏–µ + —Ä–µ–∞–≥–∏—Ä–∞–Ω–µ. –ü—Ä–∏–±–ª. 10‚Äì20 min –±–µ–∑ –ü–ò–ò.</div>
    </div>
    <div class="form-group span2">
      <label>–§—Ä–æ–Ω—Ç –Ω–∞ –∞—Ç–∞–∫–∞ (–Ω–∞—á–∏–Ω –Ω–∞ –∞—Ç–∞–∫—É–≤–∞–Ω–µ)</label>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:4px">
        <div class="front-btn active" id="frontBtn_perimeter" onclick="setFront('perimeter')" style="border:2px solid var(--accent);border-radius:6px;padding:10px 8px;text-align:center;cursor:pointer;background:var(--accent-dim)">
          <div style="font-size:20px">‚≠ï</div>
          <div style="font-family:'Rajdhani',sans-serif;font-weight:700;font-size:13px;color:var(--accent);margin-top:4px">–ü–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞</div>
          <div style="font-size:11px;color:var(--text-muted)">–∞—Ç–∞–∫–∞ –æ—Ç –≤—Å–∏—á–∫–∏ —Å—Ç—Ä–∞–Ω–∏</div>
        </div>
        <div class="front-btn" id="frontBtn_front2" onclick="setFront('front2')" style="border:2px solid var(--border);border-radius:6px;padding:10px 8px;text-align:center;cursor:pointer">
          <div style="font-size:20px">‚¨Ö‚û°</div>
          <div style="font-family:'Rajdhani',sans-serif;font-weight:700;font-size:13px;color:var(--text-muted);margin-top:4px">2 —Ñ—Ä–æ–Ω—Ç–∞</div>
          <div style="font-size:11px;color:var(--text-muted)">–∞—Ç–∞–∫–∞ –æ—Ç 2 —Å—Ç—Ä–∞–Ω–∏</div>
        </div>
        <div class="front-btn" id="frontBtn_front1" onclick="setFront('front1')" style="border:2px solid var(--border);border-radius:6px;padding:10px 8px;text-align:center;cursor:pointer">
          <div style="font-size:20px">‚û°</div>
          <div style="font-family:'Rajdhani',sans-serif;font-weight:700;font-size:13px;color:var(--text-muted);margin-top:4px">1 —Ñ—Ä–æ–Ω—Ç</div>
          <div style="font-size:11px;color:var(--text-muted)">–∞—Ç–∞–∫–∞ —Å–∞–º–æ –ø–æ —Ñ—Ä–æ–Ω—Ç–∞</div>
        </div>
      </div>
      <input type="hidden" id="frontAttack" value="perimeter">
    </div>

    <div class="section-divider span2">‚ñ∂ –õ–∏–Ω–µ–π–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç ‚Äî –¢–∞–±–ª–∏—Ü–∞ 3 <span style="font-weight:400;font-size:11px;color:var(--text-dim)">(–∫–ª–∏–∫–Ω–∏ —Ä–µ–¥ –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–ø—ä–ª–≤–∞–Ω–µ)</span></div>
    <div class="form-group">
      <label>–°–∫–æ—Ä–æ—Å—Ç –Ω–∞ –ª–∏–Ω–µ–π–Ω–æ —Ä–∞–∑–ø—Ä. v<sub>–ª</sub> <span class="unit">[m/min]</span></label>
      <input type="number" id="vl" value="1.5" min="0.1" max="600" step="0.1">
    </div>
    <div class="form-group">
      <label>–î—ä–ª–±–æ—á–∏–Ω–∞ –Ω–∞ –≥–∞—Å–µ–Ω–µ h<sub>–≥</sub> <span class="unit">[m]</span></label>
      <input type="number" id="hg" value="5" min="1" max="20" step="0.5">
      <div class="hint">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ: 5 m (—Ä—ä—á–Ω–∏) / 10 m (–ª–∞—Ñ–µ—Ç–Ω–∏)</div>
    </div>
    <div class="form-group span2">
      <div style="background:var(--bg3);border:1px solid var(--border);border-radius:6px;overflow:hidden;max-height:220px;overflow-y:auto">
        <table style="width:100%;border-collapse:collapse">
          <thead><tr style="position:sticky;top:0;background:var(--bg2)">
            <th style="padding:7px 10px;font-family:'Rajdhani',sans-serif;font-size:11px;color:var(--text-dim);text-align:left;text-transform:uppercase;letter-spacing:0.5px">–ì–æ—Ä–∏–º–æ –≤–µ—â–µ—Å—Ç–≤–æ / –æ–±–µ–∫—Ç</th>
            <th style="padding:7px 10px;font-family:'Rajdhani',sans-serif;font-size:11px;color:var(--text-dim);text-align:right;text-transform:uppercase;letter-spacing:0.5px">v<sub>–ª</sub> [m/min]</th>
          </tr></thead>
          <tbody>${t3rows}</tbody>
        </table>
      </div>
    </div>

    <div class="section-divider span2">‚ñ∂ –ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç ‚Äî –¢–∞–±–ª–∏—Ü–∞ 2 <span style="font-weight:400;font-size:11px;color:var(--text-dim)">(–∫–ª–∏–∫–Ω–∏ —Ä–µ–¥ –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–ø—ä–ª–≤–∞–Ω–µ)</span></div>
    <div class="form-group">
      <label>–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∏–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç I<sub>–Ω</sub> <span class="unit">[l/s¬∑m¬≤]</span></label>
      <input type="number" id="intenzivnost" value="0.15" min="0.05" max="0.5" step="0.01">
    </div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä—É–π–Ω–∏–∫ q<sub>—Å—Ç—Ä</sub> <span class="unit">[l/s]</span></label>
      <select id="qstr">
        <option value="3.5">–¢–∏–ø "–°" ‚Äî 3.5 l/s</option>
        <option value="7.0">–¢–∏–ø "–í" ‚Äî 7.0 l/s</option>
        <option value="20" selected>–õ–∞—Ñ–µ—Ç–µ–Ω ‚Äî 20 l/s</option>
        <option value="40">–õ–∞—Ñ–µ—Ç–µ–Ω –õ–°-40 ‚Äî 40 l/s</option>
      </select>
    </div>
    <div class="form-group span2">
      <div style="background:var(--bg3);border:1px solid var(--border);border-radius:6px;overflow:hidden;max-height:260px;overflow-y:auto">
        <table style="width:100%;border-collapse:collapse">
          <thead><tr style="position:sticky;top:0;background:var(--bg2)">
            <th style="padding:7px 10px;font-family:'Rajdhani',sans-serif;font-size:11px;color:var(--text-dim);text-align:left;text-transform:uppercase;letter-spacing:0.5px">–í–∏–¥ —Å–≥—Ä–∞–¥–∞ / –ø–æ–º–µ—â–µ–Ω–∏–µ</th>
            <th style="padding:7px 10px;font-family:'Rajdhani',sans-serif;font-size:11px;color:var(--text-dim);text-align:right;text-transform:uppercase;letter-spacing:0.5px">I<sub>–Ω</sub> [l/s¬∑m¬≤]</th>
          </tr></thead>
          <tbody>${t2rows}</tbody>
        </table>
      </div>
    </div>

    <div class="section-divider span2">‚ñ∂ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ –ø–æ–º–ø–∞—Ç–∞ –Ω–∞ –ü–ê Q<sub>–ü–ê</sub> <span class="unit">[l/s]</span></label>
      <input type="number" id="qpa" value="40" min="10" max="100" step="5">
    </div>
  </div>`;
}

function setIntenzivnost(val) {
  const num = parseFloat(val.split('‚Äì')[0]);
  if (!isNaN(num)) document.getElementById('intenzivnost').value = num;
  // highlight
  document.getElementById('intenzivnost').style.borderColor = 'var(--blue)';
  setTimeout(() => { const el = document.getElementById('intenzivnost'); if(el) el.style.borderColor = ''; }, 1500);
}

function setVl(val) {
  const num = parseFloat(val.split('‚Äì')[0]);
  if (!isNaN(num)) document.getElementById('vl').value = num;
  document.getElementById('vl').style.borderColor = 'var(--green)';
  setTimeout(() => { const el = document.getElementById('vl'); if(el) el.style.borderColor = ''; }, 1500);
}

function setFront(type) {
  document.getElementById('frontAttack').value = type;
  ['perimeter','front2','front1'].forEach(t => {
    const btn = document.getElementById('frontBtn_'+t);
    if(btn) {
      btn.style.borderColor = t === type ? 'var(--accent)' : 'var(--border)';
      btn.style.background = t === type ? 'var(--accent-dim)' : 'transparent';
      btn.querySelector('div:nth-child(2)').style.color = t === type ? 'var(--accent)' : 'var(--text-muted)';
    }
  });
}

function formTank() {
  return `<div class="form-grid">
    <div class="section-divider">‚ñ∂ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –≥–æ—Ä—è—â–∏—è —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä</div>
    <div class="form-group">
      <label>–î–∏–∞–º–µ—Ç—ä—Ä –Ω–∞ –≥–æ—Ä—è—â —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä D<sub>–≥</sub> <span class="unit">[m]</span></label>
      <input type="number" id="dg" value="20" min="1" max="100" step="1">
    </div>
    <div class="form-group">
      <label>–í–∏–¥ –≥–æ—Ä–∏–º–æ –≤–µ—â–µ—Å—Ç–≤–æ</label>
      <select id="tankProduct">
        <option value="0.08">–õ–ó–¢ (t –∫–∏–ø ‚â§ 28¬∞–°) ‚Äî I=0.08 l/s¬∑m¬≤</option>
        <option value="0.05" selected>–ì–¢ (t –∫–∏–ø > 28¬∞–°) ‚Äî I=0.05 l/s¬∑m¬≤</option>
      </select>
    </div>
    <div class="form-group">
      <label>–ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç –æ—Ö–ª–∞–∂–¥–∞–Ω–µ I<sub>–æ—Ö–ª</sub><sup>–≥</sup> <span class="unit">[l/s¬∑m]</span></label>
      <input type="number" id="iochlg" value="0.8" min="0.1" max="2" step="0.1">
      <div class="hint">–°—Ç–æ–π–Ω–æ—Å—Ç: 0.8 l/s¬∑m –ø–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞ –Ω–∞ –≥–æ—Ä—è—â —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä</div>
    </div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ –ü–ì–í q<sub>–ø–≥–≤</sub> <span class="unit">[l/s]</span></label>
      <select id="qpgv">
        <option value="2">–°–í–ü ‚Äî 2 l/s</option>
        <option value="4">–°–í–ü-4 ‚Äî 4 l/s</option>
        <option value="8" selected>–°–í–ü-8 ‚Äî 8 l/s</option>
        <option value="12">–ü–ì–í-40 ‚Äî 12 l/s</option>
        <option value="36">–ü–ì–í-120 ‚Äî 36 l/s</option>
      </select>
    </div>
    <div class="section-divider span2">‚ñ∂ –°—ä—Å–µ–¥–Ω–∏ —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä–∏</div>
    <div class="form-group">
      <label>–ë—Ä–æ–π —Å—ä—Å–µ–¥–Ω–∏ —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä–∏ n</label>
      <input type="number" id="nNeigh" value="2" min="0" max="20" step="1">
    </div>
    <div class="form-group">
      <label>–î–∏–∞–º–µ—Ç—ä—Ä –Ω–∞ —Å—ä—Å–µ–¥–µ–Ω —Ä–µ–∑–µ—Ä–≤–æ–∞—Ä D<sub>—Å</sub> <span class="unit">[m]</span></label>
      <input type="number" id="ds" value="15" min="1" max="100" step="1">
    </div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä—É–π–Ω–∏–∫ q<sub>—Å—Ç—Ä</sub> <span class="unit">[l/s]</span></label>
      <select id="qstrTank">
        <option value="3.5">–¢–∏–ø "–°" ‚Äî 3.5 l/s</option>
        <option value="7.0" selected>–¢–∏–ø "–í" ‚Äî 7.0 l/s</option>
        <option value="20">–õ–∞—Ñ–µ—Ç–µ–Ω ‚Äî 20 l/s</option>
      </select>
    </div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ –ø–æ–º–ø–∞—Ç–∞ Q<sub>–ü–ê</sub> <span class="unit">[l/s]</span></label>
      <input type="number" id="qpaTank" value="40" min="10" max="100" step="5">
    </div>
    <div class="section-divider span2">‚ñ∂ –ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª</div>
    <div class="form-group">
      <label>–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑—Ç–≤–æ—Ä–∞ C <span class="unit">[%]</span></label>
      <select id="cPO">
        <option value="0.06" selected>6%</option>
        <option value="0.03">3%</option>
      </select>
    </div>
    <div class="form-group">
      <label>–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –≤—Ä–µ–º–µ –∑–∞ –≥–∞—Å–µ–Ω–µ t<sub>–Ω</sub><sup>–≥</sup> <span class="unit">[min]</span></label>
      <input type="number" id="tng" value="15" min="5" max="30" step="1">
    </div>
  </div>`;
}

function formPowder() {
  return `<div class="form-grid">
    <div class="section-divider">‚ñ∂ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –ø–æ–∂–∞—Ä–∞</div>
    <div class="form-group">
      <label>–ü–ª–æ—â –Ω–∞ –ø–æ–∂–∞—Ä–∞ F<sub>–ø</sub> <span class="unit">[m¬≤]</span></label>
      <input type="number" id="fpPowder" value="50" min="1" max="5000" step="1">
    </div>
    <div class="form-group">
      <label>–í–∏–¥ –≥–æ—Ä–∏–º–æ –≤–µ—â–µ—Å—Ç–≤–æ</label>
      <select id="powderFuel">
        <option value="0.23">–ë–µ–Ω–∑–∏–Ω (—Ä–∞–∑–ª–∏–≤) ‚Äî 0.23 kg/s¬∑m¬≤</option>
        <option value="0.36">–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º. –º–∞—Å–ª–æ (—Ä–∞–∑–ª–∏–≤) ‚Äî 0.36 kg/s¬∑m¬≤</option>
        <option value="0.30">–ï—Ç–∏–ª–æ–≤ —Å–ø–∏—Ä—Ç ‚Äî 0.30 kg/s¬∑m¬≤</option>
        <option value="0.25">–ö–µ—Ä–æ—Å–∏–Ω ‚Äî 0.25 kg/s¬∑m¬≤</option>
        <option value="0.40">–í—Ç–µ—á–Ω–µ–Ω –≥–∞–∑ ‚Äî 0.40 kg/s¬∑m¬≤</option>
      </select>
    </div>
    <div class="form-group">
      <label>–í–∏–¥ –ø—Ä–∞—Ö–æ–≤ —Å—Ç—Ä—É–π–Ω–∏–∫</label>
      <select id="powderNozzle">
        <option value="5">–†—ä—á–µ–Ω ‚Äî 5 kg/s</option>
        <option value="40" selected>–õ–∞—Ñ–µ—Ç–µ–Ω ‚Äî 40 kg/s</option>
      </select>
    </div>
    <div class="form-group">
      <label>–ö–∞–ø–∞—Ü–∏—Ç–µ—Ç –ø—Ä–∞—Ö –Ω–∞ –ü–ê W<sub>–ü–ê</sub> <span class="unit">[kg]</span></label>
      <input type="number" id="wpaPowder" value="500" min="50" max="5000" step="50">
    </div>
    <div class="form-group">
      <label>–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –≤—Ä. –∑–∞ –≥–∞—Å–µ–Ω–µ t<sub>–Ω</sub><sup>–≥</sup> <span class="unit">[s]</span></label>
      <input type="number" id="tngPowder" value="30" min="10" max="60" step="5">
      <div class="hint">–ü—Ä–∏–µ–º–∞ —Å–µ 30 s –∑–∞ –ø–æ–≤–µ—á–µ—Ç–æ –≥–æ—Ä–∏–º–∏ —Ç–µ—á–Ω–æ—Å—Ç–∏</div>
    </div>
    <div class="form-group">
      <label>–°—Ç—Ä—É–π–Ω–∏—Ü–∏ –Ω–∞ 1 –µ–∫–∏–ø</label>
      <select id="nozzlesPerTeam">
        <option value="1" selected>1 –±—Ä. –ª–∞—Ñ–µ—Ç–µ–Ω</option>
        <option value="2">2 –±—Ä. –ª–∞—Ñ–µ—Ç–Ω–∏</option>
        <option value="2r">2 –±—Ä. —Ä—ä—á–Ω–∏</option>
        <option value="4r">4 –±—Ä. —Ä—ä—á–Ω–∏</option>
      </select>
    </div>
  </div>`;
}

function formFoam() {
  return `<div class="form-grid">
    <div class="section-divider">‚ñ∂ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –ø–æ–º–µ—â–µ–Ω–∏–µ—Ç–æ</div>
    <div class="form-group">
      <label>–®–∏—Ä–∏–Ω–∞ a <span class="unit">[m]</span></label>
      <input type="number" id="foamA" value="20" min="1" max="200" step="1">
    </div>
    <div class="form-group">
      <label>–î—ä–ª–∂–∏–Ω–∞ l <span class="unit">[m]</span></label>
      <input type="number" id="foamL" value="30" min="1" max="200" step="1">
    </div>
    <div class="form-group">
      <label>–í–∏—Å–æ—á–∏–Ω–∞ –Ω–∞ –≥–æ—Ä–∏–º–æ—Ç–æ –Ω–∞—Ç–æ–≤–∞—Ä–≤–∞–Ω–µ h<sub>–ø.–Ω.</sub> <span class="unit">[m]</span></label>
      <input type="number" id="foamHpn" value="0.5" min="0" max="10" step="0.1">
    </div>
    <div class="form-group">
      <label>–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–µ–±–µ–ª–∏–Ω–∞ –Ω–∞ –ø–µ–Ω–µ–Ω–∏—è —Å–ª–æ–π z <span class="unit">[m]</span></label>
      <input type="number" id="foamZ" value="0.3" min="0.3" max="2" step="0.1">
      <div class="hint">–ú–∏–Ω–∏–º—É–º 0.3 m</div>
    </div>
    <div class="section-divider span2">‚ñ∂ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –ø–µ–Ω–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</div>
    <div class="form-group">
      <label>–í–∏–¥ –ø–µ–Ω–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä (–ü–ì–í)</label>
      <select id="foamGen">
        <option value="2,100,12,40,25">–ü–ì–í-40 ‚Äî 2 l/s —Ä–∞–∑—Ç–≤–æ—Ä, –∫—Ä–∞—Ç–Ω–æ—Å—Ç 100</option>
        <option value="6,100,36,120,75" selected>–ü–ì–í-120 ‚Äî 6 l/s —Ä–∞–∑—Ç–≤–æ—Ä, –∫—Ä–∞—Ç–Ω–æ—Å—Ç 100</option>
        <option value="5.64,8,3,60,50">–°–í–ü ‚Äî 5.64 l/s —Ä–∞–∑—Ç–≤–æ—Ä, –∫—Ä–∞—Ç–Ω–æ—Å—Ç 8</option>
        <option value="7.52,8,4,80,66">–°–í–ü-4 ‚Äî 7.52 l/s —Ä–∞–∑—Ç–≤–æ—Ä, –∫—Ä–∞—Ç–Ω–æ—Å—Ç 8</option>
        <option value="15.04,8,8,160,133">–°–í–ü-8 ‚Äî 15.04 l/s —Ä–∞–∑—Ç–≤–æ—Ä, –∫—Ä–∞—Ç–Ω–æ—Å—Ç 8</option>
      </select>
    </div>
    <div class="form-group">
      <label>–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑—Ç–≤–æ—Ä C <span class="unit">[%]</span></label>
      <select id="foamConc">
        <option value="0.06" selected>6%</option>
        <option value="0.03">3%</option>
      </select>
    </div>
    <div class="form-group">
      <label>–†–∞–∑—Ö–æ–¥ –Ω–∞ –ø–æ–º–ø–∞—Ç–∞ Q<sub>–ü–ê</sub> <span class="unit">[l/s]</span></label>
      <input type="number" id="qpaFoam" value="40" min="10" max="100" step="5">
    </div>
    <div class="form-group">
      <label>–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –≤—Ä. –∑–∞ –≥–∞—Å–µ–Ω–µ t<sub>–Ω</sub><sup>–≥</sup> <span class="unit">[min]</span></label>
      <input type="number" id="tngFoam" value="15" min="5" max="30" step="1">
    </div>
  </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CALCULATIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calculate() {
  if (selectedScenario === 'fire') calcFire();
  else if (selectedScenario === 'tank') calcTank();
  else if (selectedScenario === 'powder') calcPowder();
  else if (selectedScenario === 'foam') calcFoam();
  currentStep = 2;
  render();
}

function v(id) { return parseFloat(document.getElementById(id).value) || 0; }
function sv(id) { return document.getElementById(id).value; }

function calcFire() {
  const tsv = v('tsv'), vl = v('vl'), hg = v('hg');
  const In = v('intenzivnost'), qstr = v('qstr'), qpa = v('qpa');
  const shape = sv('fireShape');
  const front = sv('frontAttack'); // 'perimeter', 'front2', 'front1'

  // ‚îÄ‚îÄ –†–∞–¥–∏—É—Å –Ω–∞ –ø–æ–∂–∞—Ä–∞ R–ø ‚îÄ‚îÄ
  const Rp = vl * tsv;

  // ‚îÄ‚îÄ –ü–ª–æ—â –Ω–∞ –ø–æ–∂–∞—Ä–∞ F–ø (–ø–æ —Ñ–æ—Ä–º–∞) ‚îÄ‚îÄ
  let Fp;
  if (shape === 'round') {
    if (tsv <= 10) Fp = Math.PI * Math.pow(vl * tsv, 2);
    else { const t2 = tsv - 10; Fp = Math.PI * Math.pow(vl*5 + vl*t2, 2); }
  } else if (shape === 'rect') {
    // –ø—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∞: —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤ 2 –ø–æ—Å–æ–∫–∏ (–∞ = —à–∏—Ä–∏–Ω–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–∞)
    // –ø—Ä–∏–µ–º–∞–º–µ a = 2*Rp (—à–∏—Ä–∏–Ω–∞), –¥—ä–ª. = Rp
    const a = 2 * Rp; const l = Rp;
    Fp = a * l;
  } else if (shape === 'semicircle') {
    Fp = Math.PI * Rp * Rp / 2;
  } else { // sector (1/4 –∫—Ä—ä–≥)
    Fp = Math.PI * Rp * Rp / 4;
  }

  // ‚îÄ‚îÄ –ü–ª–æ—â –Ω–∞ –≥–∞—Å–µ–Ω–µ F–≥ (–∑–∞–≤–∏—Å–∏ –æ—Ç —Ñ–æ—Ä–º–∞ –ò —Ñ—Ä–æ–Ω—Ç) ‚îÄ‚îÄ
  let Fg, frontLabel;
  if (shape === 'round') {
    if (front === 'perimeter') {
      frontLabel = '–ü–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞ (–∫—Ä—ä–≥)';
      if (Fp <= Math.PI * hg * hg) Fg = Fp;
      else Fg = 2 * Math.PI * (Rp - hg) * hg;
    } else if (front === 'front2') {
      frontLabel = '2 —Ñ—Ä–æ–Ω—Ç–∞ (–∫—Ä—ä–≥)';
      // 2 –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∏ —Å–µ–≥–º–µ–Ω—Ç–∞: n=2, a=2*hg (—à–∏—Ä–∏–Ω–∞ –¥—ä–≥–∞)
      if (Fp <= 4 * hg * hg) Fg = Fp;
      else Fg = 2 * (2 * Rp) * hg - 4 * hg * hg; // Fg = (a-2h–≥)√óh–≥√ón, –ø—Ä–∏ n=2
    } else {
      frontLabel = '1 —Ñ—Ä–æ–Ω—Ç (–∫—Ä—ä–≥)';
      if (Fp <= hg * hg) Fg = Fp;
      else Fg = 2 * Rp * hg - hg * hg; // Fg = (a - h–≥)√óh–≥
    }
  } else if (shape === 'rect') {
    const a = 2 * Rp;
    if (front === 'perimeter') {
      frontLabel = '–ü–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞ (–ø—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∏–∫)';
      if (Fp <= 4 * hg * hg) Fg = Fp;
      else Fg = 2 * (a + Rp) * hg - 4 * hg * hg;
    } else if (front === 'front2') {
      frontLabel = '2 —Ñ—Ä–æ–Ω—Ç–∞ (–ø—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∏–∫)';
      if (Fp <= 4 * hg * a) Fg = Fp;
      else Fg = 2 * a * hg;
    } else {
      frontLabel = '1 —Ñ—Ä–æ–Ω—Ç (–ø—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∏–∫)';
      if (Fp <= a * hg) Fg = Fp;
      else Fg = a * hg;
    }
  } else if (shape === 'semicircle') {
    frontLabel = front === 'perimeter' ? '–ü–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞ (–ø–æ–ª—É–∫—Ä—ä–≥)' : front === 'front2' ? '2 —Ñ—Ä–æ–Ω—Ç–∞ (–ø–æ–ª—É–∫—Ä—ä–≥)' : '1 —Ñ—Ä–æ–Ω—Ç (–ø–æ–ª—É–∫—Ä—ä–≥)';
    if (Fp <= Math.PI * hg * hg / 2) Fg = Fp;
    else Fg = Math.PI * (Rp - hg) * hg;
  } else { // sector
    frontLabel = front === 'perimeter' ? '–ü–æ –ø–µ—Ä–∏–º–µ—Ç—ä—Ä–∞ (—Å–µ–∫—Ç–æ—Ä)' : '1 —Ñ—Ä–æ–Ω—Ç (—Å–µ–∫—Ç–æ—Ä)';
    if (Fp <= Math.PI * hg * hg / 4) Fg = Fp;
    else Fg = Math.PI * (Rp - hg) * hg / 2;
  }
  Fg = Math.min(Fg, Fp);
  if (Fg < 0) Fg = Fp; // fallback

  // ‚îÄ‚îÄ –†–∞–∑—Ö–æ–¥ –∑–∞ –≥–∞—Å–µ–Ω–µ ‚îÄ‚îÄ
  const Qng = In * Fg;

  // ‚îÄ‚îÄ –°—Ç—Ä—É–π–Ω–∏—Ü–∏ ‚îÄ‚îÄ
  const Nstr = Math.ceil(Qng / qstr);

  // ‚îÄ‚îÄ –ï–∫–∏–ø–∏ ‚îÄ‚îÄ
  const nstrEkip = qstr <= 3.5 ? 4 : qstr <= 7 ? 2 : 1;
  const Nekipi = Math.ceil(Nstr / nstrEkip);

  // ‚îÄ‚îÄ –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ ‚îÄ‚îÄ
  const Npa = Math.ceil(Qng / (0.8 * qpa));

  results = { Fp, Fg, Qng, Nstr, Nekipi, Npa, Rp, hg, tsv, vl, In, qstr, qpa, frontLabel, shape, front };
  inputData = { tsv, vl, hg, In, qstr, qpa, shape, front };
}

function calcTank() {
  const Dg = v('dg'), Ds = v('ds');
  const Iochlg = v('iochlg');
  const nNeigh = v('nNeigh');
  const Ing = parseFloat(sv('tankProduct'));
  const qpgv = v('qpgv'), qstrT = v('qstrTank');
  const qpaT = v('qpaTank');
  const cPO = parseFloat(sv('cPO'));
  const tng = v('tng');

  // –û—Ö–ª–∞–∂–¥–∞–Ω–µ –≥–æ—Ä—è—â
  const Qochlg = Iochlg * Math.PI * Dg;
  const Nstr_ochlg = Math.ceil(Qochlg / qstrT);
  const Nekipi_ochlg = Math.ceil(Nstr_ochlg / 2);

  // –û—Ö–ª–∞–∂–¥–∞–Ω–µ —Å—ä—Å–µ–¥–Ω–∏ (I–æ—Ö–ª_—Å = 0.2 l/s¬∑m)
  const Iochls = 0.2;
  const Qochls = Iochls * Math.PI * Ds / 2 * nNeigh;
  const Nstr_ochls = Math.ceil(Qochls / qstrT);

  // –ì–∞—Å–µ–Ω–µ —Å –ø—è–Ω–∞
  const Fg = Math.PI * Math.pow(Dg / 2, 2);
  const Qg_pgv = Ing * Fg;
  const Npgv = Math.ceil(Qg_pgv / qpgv);
  const nPgvEkip = 2;
  const Nekipi_g = Math.ceil(Npgv / nPgvEkip);

  // –ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª
  const Wpo = Qg_pgv * cPO * tng * 60;

  const Qtotal = Qochlg + Qochls + Qg_pgv;
  const Npa = Math.ceil(Qtotal / (0.8 * qpaT));

  const Nekipi_total = Nekipi_ochlg + Math.ceil(Nstr_ochls/2) + Nekipi_g;

  results = { Dg, Ds, Fg, Qochlg, Nstr_ochlg, Nekipi_ochlg, Qochls, Nstr_ochls,
              Qg_pgv, Npgv, Nekipi_g, Wpo, Qtotal, Npa, Nekipi_total };
  inputData = { Dg, Ds, Ing, Iochlg, qpgv, qstrT, qpaT, cPO, tng, nNeigh };
}

function calcPowder() {
  const Fp = v('fpPowder');
  const In = parseFloat(sv('powderFuel'));
  const qstr = parseFloat(sv('powderNozzle'));
  const wpa = v('wpaPowder');
  const tng = v('tngPowder');
  const npt = sv('nozzlesPerTeam');

  const Qng = In * Fp;
  const Nstr = Math.ceil(Qng / qstr);
  let nPerTeam = parseInt(npt) || 1;
  const Nekipi = Math.ceil(Nstr / nPerTeam);
  const Wp = Qng * tng;
  const Npa = Math.ceil(Wp / wpa);

  results = { Fp, In, Qng, Nstr, Nekipi, Wp, Npa, qstr, tng };
  inputData = { Fp, In, qstr, wpa, tng };
}

function calcFoam() {
  const a = v('foamA'), l = v('foamL');
  const hpn = v('foamHpn'), z = v('foamZ');
  const qpaF = v('qpaFoam'), tng = v('tngFoam');
  const conc = parseFloat(sv('foamConc'));
  const genData = sv('foamGen').split(',').map(Number);
  const [qRaztvr, kratnost, Qpgv_pyana] = genData;

  const ho = hpn + z;
  const V = a * l * ho;
  const Qpgv_needed = V / (tng * 60 * kratnost); // m3/s –ø—è–Ω–∞ ‚Üí l/s —Ä–∞–∑—Ç–≤–æ—Ä
  const Qrst = Qpgv_needed * 1000; // l/s —Ä–∞–∑—Ç–≤–æ—Ä
  const Npgv = Math.ceil(Qrst / qRaztvr);
  const Wpo = Qrst * conc * tng * 60;
  const Npa = Math.ceil(Qrst / (0.8 * qpaF));
  const NekipiF = Math.ceil(Npgv / 2);

  results = { a, l, ho, V, Qrst, Npgv, Wpo, Npa, NekipiF, kratnost, qRaztvr, tng };
  inputData = { a, l, hpn, z, qRaztvr, kratnost, conc, qpaF, tng };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RESULTS RENDERING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderStep2() {
  const s = scenarios.find(x=>x.id===selectedScenario);
  const renders = { fire: resultsFireHTML, tank: resultsTankHTML, powder: resultsPowderHTML, foam: resultsFoamHTML };
  return `<div class="panel">
    <div class="panel-title">${s.icon} –†–µ–∑—É–ª—Ç–∞—Ç–∏ ‚Äî ${s.name} <span class="badge">–°–¢–™–ü–ö–ê 3/3</span></div>
    <div class="panel-sub">–ò–∑—á–∏—Å–ª–µ–Ω–∏ —Å–∏–ª–∏ –∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ –º–µ—Ç–æ–¥–∏–∫–∞—Ç–∞ –Ω–∞ –ì–î–ü–ë–ó–ù. –í—Å–∏—á–∫–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —Å–∞ –∑–∞–∫—Ä—ä–≥–ª–µ–Ω–∏ –Ω–∞–≥–æ—Ä–µ (‚àû).</div>
    ${renders[selectedScenario]()}
    <div class="btn-row">
      <button class="btn-secondary" onclick="goToStep(1)">‚Üê –ü—Ä–æ–º–µ–Ω–∏ –¥–∞–Ω–Ω–∏</button>
      <button class="btn-secondary" onclick="goToStep(0)">üîÑ –ù–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏–π</button>
      <button class="btn-success" onclick="window.print()">üñ®Ô∏è –û—Ç–ø–µ—á–∞—Ç–∞–π</button>
    </div>
  </div>`;
}

function resultsFireHTML() {
  const r = results;
  const fmtN = (n) => n.toFixed(1);
  const shapeNames = { round:'–ö—Ä—ä–≥–æ–≤–∞', rect:'–ü—Ä–∞–≤–æ—ä–≥—ä–ª–Ω–∞', semicircle:'–ü–æ–ª—É–∫—Ä—ä–≥–æ–≤–∞', sector:'–°–µ–∫—Ç–æ—Ä–Ω–∞' };
  return `
    <div class="results-grid">
      <div class="result-card"><div class="result-label">–†–∞–¥–∏—É—Å –Ω–∞ –ø–æ–∂–∞—Ä–∞ R<sub>–ø</sub></div><div class="result-value">${fmtN(r.Rp)}</div><div class="result-unit">m</div></div>
      <div class="result-card"><div class="result-label">–ü–ª–æ—â –Ω–∞ –ø–æ–∂–∞—Ä–∞ F<sub>–ø</sub></div><div class="result-value">${fmtN(r.Fp)}</div><div class="result-unit">m¬≤</div></div>
      <div class="result-card"><div class="result-label">–ü–ª–æ—â –Ω–∞ –≥–∞—Å–µ–Ω–µ F<sub>–≥</sub></div><div class="result-value">${fmtN(r.Fg)}</div><div class="result-unit">m¬≤</div></div>
      <div class="result-card"><div class="result-label">–ù–µ–æ–±—Ö–æ–¥–∏–º —Ä–∞–∑—Ö–æ–¥ Q<sub>–Ω</sub><sup>–≥</sup></div><div class="result-value">${fmtN(r.Qng)}</div><div class="result-unit">l/s</div></div>
      <div class="result-card"><div class="result-label">–ë—Ä–æ–π —Å—Ç—Ä—É–π–Ω–∏—Ü–∏ N<sub>—Å—Ç—Ä</sub></div><div class="result-value">${r.Nstr}</div><div class="result-unit">–±—Ä.</div></div>
      <div class="result-card"><div class="result-label">–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ N<sub>–ü–ê</sub></div><div class="result-value">${r.Npa}</div><div class="result-unit">–±—Ä.</div></div>
    </div>
    <div class="formula-section">
      <div class="formula-title">üìê –•–æ–¥ –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ</div>
      <div class="formula-row"><div class="formula-desc">–§–æ—Ä–º–∞ –Ω–∞ –ø–æ–∂–∞—Ä–∞ / —Ñ—Ä–æ–Ω—Ç –Ω–∞ –∞—Ç–∞–∫–∞</div><div class="formula-calc">${shapeNames[r.shape]} / ${r.frontLabel}</div></div>
      <div class="formula-row"><div class="formula-desc">–†–∞–¥–∏—É—Å –Ω–∞ –ø–æ–∂–∞—Ä–∞ R<sub>–ø</sub> = v<sub>–ª</sub> √ó t<sub>—Å–≤</sub> = ${r.vl} √ó ${r.tsv}</div><div class="formula-calc"><b>${fmtN(r.Rp)} m</b></div></div>
      <div class="formula-row"><div class="formula-desc">–ü–ª–æ—â –Ω–∞ –ø–æ–∂–∞—Ä–∞ F<sub>–ø</sub></div><div class="formula-calc"><b>${fmtN(r.Fp)} m¬≤</b></div></div>
      <div class="formula-row"><div class="formula-desc">–ü–ª–æ—â –Ω–∞ –≥–∞—Å–µ–Ω–µ F<sub>–≥</sub> (h<sub>–≥</sub> = ${r.hg} m, ${r.frontLabel})</div><div class="formula-calc"><b>${fmtN(r.Fg)} m¬≤</b></div></div>
      <div class="formula-row"><div class="formula-desc">–ù–µ–æ–±—Ö–æ–¥–∏–º —Ä–∞–∑—Ö–æ–¥ Q<sub>–Ω</sub><sup>–≥</sup> = I<sub>–Ω</sub> √ó F<sub>–≥</sub> = ${r.In} √ó ${fmtN(r.Fg)}</div><div class="formula-calc"><b>${fmtN(r.Qng)} l/s</b></div></div>
      <div class="formula-row"><div class="formula-desc">–ë—Ä–æ–π —Å—Ç—Ä—É–π–Ω–∏—Ü–∏ N<sub>—Å—Ç—Ä</sub> = Q<sub>–Ω</sub><sup>–≥</sup> / q<sub>—Å—Ç—Ä</sub> = ${fmtN(r.Qng)} / ${r.qstr}</div><div class="formula-calc"><b>${r.Nstr} –±—Ä.</b></div></div>
      <div class="formula-row"><div class="formula-desc">–ë—Ä–æ–π –ü–ê = Q<sub>–Ω</sub><sup>–≥</sup> / (0.8 √ó Q<sub>–ü–ê</sub>) = ${fmtN(r.Qng)} / (0.8 √ó ${r.qpa})</div><div class="formula-calc"><b>${r.Npa} –±—Ä.</b></div></div>
    </div>
    <table class="summary-table">
      <thead><tr><th>–†–µ—Å—É—Ä—Å</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th><th>–ó–∞–±–µ–ª–µ–∂–∫–∞</th></tr></thead>
      <tbody>
        <tr><td>–°—Ç—Ä—É–π–Ω–∏—Ü–∏ (q = ${r.qstr} l/s)</td><td class="num">${r.Nstr} –±—Ä.</td><td style="color:var(--text-muted)">${r.frontLabel}</td></tr>
        <tr><td>–ï–∫–∏–ø–∏</td><td class="num">${r.Nekipi} –µ–∫–∏–ø.</td><td style="color:var(--text-muted)">‚Äî</td></tr>
        <tr><td>–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ (Q<sub>–ü–ê</sub> = ${r.qpa} l/s)</td><td class="num">${r.Npa} –±—Ä.</td><td style="color:var(--text-muted)">‚Äî</td></tr>
      </tbody>
    </table>`;
}

function resultsTankHTML() {
  const r = results;
  const fmtN = (n) => n.toFixed(2);
  return `
    <div class="results-grid">
      <div class="result-card"><div class="result-label">–ü–ª–æ—â –Ω–∞ –≥–æ—Ä–µ–Ω–µ F<sub>–≥</sub></div><div class="result-value">${(r.Fg).toFixed(1)}</div><div class="result-unit">m¬≤</div></div>
      <div class="result-card"><div class="result-label">–†–∞–∑—Ö–æ–¥ –æ—Ö–ª. –≥–æ—Ä—è—â Q<sub>–æ—Ö–ª</sub><sup>–≥</sup></div><div class="result-value">${fmtN(r.Qochlg)}</div><div class="result-unit">l/s</div></div>
      <div class="result-card"><div class="result-label">–†–∞–∑—Ö–æ–¥ –æ—Ö–ª. —Å—ä—Å–µ–¥–Ω–∏ Q<sub>–æ—Ö–ª</sub><sup>—Å</sup></div><div class="result-value">${fmtN(r.Qochls)}</div><div class="result-unit">l/s</div></div>
      <div class="result-card"><div class="result-label">–†–∞–∑—Ö–æ–¥ –ø—è–Ω–∞ Q<sub>–Ω</sub><sup>–≥</sup></div><div class="result-value">${fmtN(r.Qg_pgv)}</div><div class="result-unit">l/s</div></div>
      <div class="result-card"><div class="result-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ–Ω–æ–æ–±—Ä. W<sub>–ü–û</sub></div><div class="result-value">${(r.Wpo).toFixed(0)}</div><div class="result-unit">l</div></div>
      <div class="result-card"><div class="result-label">–û–±—â —Ä–∞–∑—Ö–æ–¥ Q<sub>total</sub></div><div class="result-value">${fmtN(r.Qtotal)}</div><div class="result-unit">l/s</div></div>
    </div>
    <div class="formula-section">
      <div class="formula-title">üìê –•–æ–¥ –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ</div>
      <div class="formula-row"><div class="formula-desc">–ü–ª–æ—â –Ω–∞ –≥–æ—Ä–µ–Ω–µ F<sub>–≥</sub> = œÄ√ó(D/2)¬≤ = œÄ√ó(${r.Dg}/2)¬≤</div><div class="formula-calc">= ${(r.Fg).toFixed(1)} m¬≤</div></div>
      <div class="formula-row"><div class="formula-desc">–†–∞–∑—Ö–æ–¥ –æ—Ö–ª–∞–∂–¥–∞–Ω–µ –≥–æ—Ä—è—â Q = I<sub>–æ—Ö–ª</sub>√óœÄ√óD = ${inputData.Iochlg}√óœÄ√ó${r.Dg}</div><div class="formula-calc">= ${fmtN(r.Qochlg)} l/s</div></div>
      <div class="formula-row"><div class="formula-desc">–†–∞–∑—Ö–æ–¥ –æ—Ö–ª–∞–∂–¥–∞–Ω–µ —Å—ä—Å–µ–¥–Ω–∏ (I=0.2 l/s¬∑m, D<sub>—Å</sub>=${r.Ds} m, n=${inputData.nNeigh})</div><div class="formula-calc">= ${fmtN(r.Qochls)} l/s</div></div>
      <div class="formula-row"><div class="formula-desc">–†–∞–∑—Ö–æ–¥ –ø—è–Ω–∞ Q = I<sub>–Ω</sub><sup>–≥</sup> √ó F<sub>–≥</sub> = ${inputData.Ing} √ó ${(r.Fg).toFixed(1)}</div><div class="formula-calc">= ${fmtN(r.Qg_pgv)} l/s</div></div>
      <div class="formula-row"><div class="formula-desc">–ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª W<sub>–ü–û</sub> = Q√óC√ót = ${fmtN(r.Qg_pgv)}√ó${inputData.cPO}√ó${inputData.tng*60} s</div><div class="formula-calc">= ${(r.Wpo).toFixed(0)} l</div></div>
    </div>
    <table class="summary-table">
      <thead><tr><th>–†–µ—Å—É—Ä—Å</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th><th>–ó–∞–±–µ–ª–µ–∂–∫–∞</th></tr></thead>
      <tbody>
        <tr><td>–°—Ç—Ä—É–π–Ω–∏—Ü–∏ –æ—Ö–ª. (–≥–æ—Ä—è—â)</td><td class="num">${r.Nstr_ochlg} –±—Ä.</td><td style="color:var(--text-muted)">q=${inputData.qstrT} l/s</td></tr>
        <tr><td>–ï–∫–∏–ø–∏ –æ—Ö–ª. (–≥–æ—Ä—è—â)</td><td class="num">${r.Nekipi_ochlg} –µ–∫–∏–ø.</td><td style="color:var(--text-muted)">‚Äî</td></tr>
        <tr><td>–°—Ç—Ä—É–π–Ω–∏—Ü–∏ –æ—Ö–ª. (—Å—ä—Å–µ–¥–Ω–∏)</td><td class="num">${r.Nstr_ochls} –±—Ä.</td><td style="color:var(--text-muted)">q=${inputData.qstrT} l/s</td></tr>
        <tr><td>–ü–µ–Ω–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –ü–ì–í</td><td class="num">${r.Npgv} –±—Ä.</td><td style="color:var(--text-muted)">q=${inputData.qpgv} l/s</td></tr>
        <tr><td>–ï–∫–∏–ø–∏ –≥–∞—Å–µ–Ω–µ —Å –ø—è–Ω–∞</td><td class="num">${r.Nekipi_g} –µ–∫–∏–ø.</td><td style="color:var(--text-muted)">‚Äî</td></tr>
        <tr><td>–û–±—â–æ –µ–∫–∏–ø–∏</td><td class="num">${r.Nekipi_total} –µ–∫–∏–ø.</td><td style="color:var(--text-muted)">‚Äî</td></tr>
        <tr><td>–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</td><td class="num">${r.Npa} –±—Ä.</td><td style="color:var(--text-muted)">Q<sub>–ü–ê</sub>=${inputData.qpaT} l/s</td></tr>
      </tbody>
    </table>`;
}

function resultsPowderHTML() {
  const r = results;
  return `
    <div class="results-grid">
      <div class="result-card"><div class="result-label">–ü–ª–æ—â –Ω–∞ –ø–æ–∂–∞—Ä–∞ F<sub>–ø</sub></div><div class="result-value">${r.Fp}</div><div class="result-unit">m¬≤</div></div>
      <div class="result-card"><div class="result-label">–†–∞–∑—Ö–æ–¥ –ø—Ä–∞—Ö Q<sub>–Ω</sub><sup>–≥</sup></div><div class="result-value">${r.Qng.toFixed(2)}</div><div class="result-unit">kg/s</div></div>
      <div class="result-card"><div class="result-label">–ù–µ–æ–±—Ö–æ–¥–∏–º –ø—Ä–∞—Ö W<sub>–ø</sub></div><div class="result-value">${r.Wp.toFixed(1)}</div><div class="result-unit">kg</div></div>
      <div class="result-card"><div class="result-label">–ë—Ä–æ–π –ø—Ä–∞—Ö–æ–≤–∏ —Å—Ç—Ä—É–π–Ω–∏—Ü–∏</div><div class="result-value">${r.Nstr}</div><div class="result-unit">–±—Ä.</div></div>
      <div class="result-card"><div class="result-label">–ë—Ä–æ–π –µ–∫–∏–ø–∏</div><div class="result-value">${r.Nekipi}</div><div class="result-unit">–µ–∫–∏–ø.</div></div>
      <div class="result-card"><div class="result-label">–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</div><div class="result-value">${r.Npa}</div><div class="result-unit">–±—Ä.</div></div>
    </div>
    <div class="formula-section">
      <div class="formula-title">üìê –•–æ–¥ –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ</div>
      <div class="formula-row"><div class="formula-desc">–ù–µ–æ–±—Ö–æ–¥–∏–º —Ä–∞–∑—Ö–æ–¥ –ø—Ä–∞—Ö Q<sub>–Ω</sub><sup>–≥</sup> = I<sub>–Ω</sub> √ó F<sub>–ø</sub> = ${r.In} √ó ${r.Fp}</div><div class="formula-calc">= ${r.Qng.toFixed(2)} kg/s</div></div>
      <div class="formula-row"><div class="formula-desc">–ë—Ä–æ–π —Å—Ç—Ä—É–π–Ω–∏—Ü–∏ N = Q / q<sub>—Å—Ç—Ä</sub> = ${r.Qng.toFixed(2)} / ${r.qstr}</div><div class="formula-calc">= ${r.Nstr} –±—Ä.</div></div>
      <div class="formula-row"><div class="formula-desc">–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∫–æ–ª. –ø—Ä–∞—Ö W<sub>–ø</sub> = Q<sub>–Ω</sub><sup>–≥</sup> √ó t<sub>–Ω</sub><sup>–≥</sup> = ${r.Qng.toFixed(2)} √ó ${r.tng}</div><div class="formula-calc">= ${r.Wp.toFixed(1)} kg</div></div>
    </div>
    <div class="alert alert-warn">‚ö†Ô∏è <span>–ì–æ—Ä–µ–Ω–µ—Ç–æ –≤ –∑–∞—Ç–≤–æ—Ä–µ–Ω –æ–±–µ–º –∏–∑–∏—Å–∫–≤–∞ –ø–æ-–≤–∏—Å–æ–∫–∞ –∏–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç. –ó–∞ –≥–∞–∑–æ–≤–∏ —Ñ–æ–Ω—Ç–∞–Ω–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª–Ω–∏—è —Ä–∞–∑—Ö–æ–¥ –ø–æ –¢–∞–±–ª–∏—Ü–∞ 5 –æ—Ç –º–µ—Ç–æ–¥–∏–∫–∞—Ç–∞.</span></div>
    <table class="summary-table">
      <thead><tr><th>–†–µ—Å—É—Ä—Å</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th></tr></thead>
      <tbody>
        <tr><td>–ü—Ä–∞—Ö–æ–≤–∏ —Å—Ç—Ä—É–π–Ω–∏—Ü–∏ (${r.qstr} kg/s)</td><td class="num">${r.Nstr} –±—Ä.</td></tr>
        <tr><td>–ï–∫–∏–ø–∏</td><td class="num">${r.Nekipi} –µ–∫–∏–ø.</td></tr>
        <tr><td>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞—Ö</td><td class="num">${r.Wp.toFixed(1)} kg</td></tr>
        <tr><td>–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ (–ø—Ä–∞—Ö–æ–≤–∏)</td><td class="num">${r.Npa} –±—Ä.</td></tr>
      </tbody>
    </table>`;
}

function resultsFoamHTML() {
  const r = results;
  return `
    <div class="results-grid">
      <div class="result-card"><div class="result-label">–û–±–µ–º –∑–∞ –∑–∞–ø—ä–ª–≤–∞–Ω–µ V</div><div class="result-value">${r.V.toFixed(1)}</div><div class="result-unit">m¬≥</div></div>
      <div class="result-card"><div class="result-label">–†–∞–∑—Ö–æ–¥ —Ä–∞–∑—Ç–≤–æ—Ä Q<sub>—Ä—Å—Ç</sub></div><div class="result-value">${r.Qrst.toFixed(2)}</div><div class="result-unit">l/s</div></div>
      <div class="result-card"><div class="result-label">–ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª W<sub>–ü–û</sub></div><div class="result-value">${r.Wpo.toFixed(1)}</div><div class="result-unit">l</div></div>
      <div class="result-card"><div class="result-label">–ü–µ–Ω–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –ü–ì–í</div><div class="result-value">${r.Npgv}</div><div class="result-unit">–±—Ä.</div></div>
      <div class="result-card"><div class="result-label">–ï–∫–∏–ø–∏</div><div class="result-value">${r.NekipiF}</div><div class="result-unit">–µ–∫–∏–ø.</div></div>
      <div class="result-card"><div class="result-label">–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</div><div class="result-value">${r.Npa}</div><div class="result-unit">–±—Ä.</div></div>
    </div>
    <div class="formula-section">
      <div class="formula-title">üìê –•–æ–¥ –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ</div>
      <div class="formula-row"><div class="formula-desc">–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –≤–∏—Å–æ—á–∏–Ω–∞ –∑–∞ –∑–∞–ø—ä–ª–≤–∞–Ω–µ h<sub>–æ</sub> = h<sub>–ø.–Ω.</sub> + z = ${inputData.hpn} + ${inputData.z}</div><div class="formula-calc">= ${r.ho.toFixed(1)} m</div></div>
      <div class="formula-row"><div class="formula-desc">–û–±–µ–º –ø—è–Ω–∞ V = a √ó l √ó h<sub>–æ</sub> = ${r.a} √ó ${r.l} √ó ${r.ho.toFixed(1)}</div><div class="formula-calc">= ${r.V.toFixed(1)} m¬≥</div></div>
      <div class="formula-row"><div class="formula-desc">–†–∞–∑—Ö–æ–¥ —Ä–∞–∑—Ç–≤–æ—Ä Q = V / (t √ó 60 √ó –∫—Ä–∞—Ç–Ω–æ—Å—Ç) = ${r.V.toFixed(1)} / (${r.tng}√ó60√ó${r.kratnost})</div><div class="formula-calc">= ${r.Qrst.toFixed(2)} l/s</div></div>
      <div class="formula-row"><div class="formula-desc">–ë—Ä–æ–π –ü–ì–í = Q / q<sub>–ü–ì–í</sub> = ${r.Qrst.toFixed(2)} / ${r.qRaztvr}</div><div class="formula-calc">= ${r.Npgv} –±—Ä.</div></div>
      <div class="formula-row"><div class="formula-desc">–ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª W<sub>–ü–û</sub> = Q √ó C √ó t√ó60</div><div class="formula-calc">= ${r.Wpo.toFixed(1)} l</div></div>
    </div>
    <div class="alert alert-info">‚ÑπÔ∏è <span>–í—Ä–µ–º–µ—Ç–æ –∑–∞ –∑–∞–ø—ä–ª–≤–∞–Ω–µ –µ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ. –û—Ç–≤–æ—Ä–∏—Ç–µ –≤ –ø–æ–º–µ—â–µ–Ω–∏–µ—Ç–æ —É–≤–µ–ª–∏—á–∞–≤–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—è–Ω–∞. –ü—Ä–∏ –∫—Ä–∞—Ç–Ω–æ—Å—Ç > 80 —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –ü–ì–í —Å –≤–∏—Å–æ–∫–∞ –∫—Ä–∞—Ç–Ω–æ—Å—Ç.</span></div>
    <table class="summary-table">
      <thead><tr><th>–†–µ—Å—É—Ä—Å</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th></tr></thead>
      <tbody>
        <tr><td>–ü–µ–Ω–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –ü–ì–í (${r.qRaztvr} l/s —Ä–∞–∑—Ç–≤–æ—Ä)</td><td class="num">${r.Npgv} –±—Ä.</td></tr>
        <tr><td>–ï–∫–∏–ø–∏</td><td class="num">${r.NekipiF} –µ–∫–∏–ø.</td></tr>
        <tr><td>–ü–µ–Ω–æ–æ–±—Ä–∞–∑—É–≤–∞—Ç–µ–ª</td><td class="num">${r.Wpo.toFixed(1)} l</td></tr>
        <tr><td>–ü–æ–∂–∞—Ä–Ω–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</td><td class="num">${r.Npa} –±—Ä.</td></tr>
      </tbody>
    </table>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function goToStep(n) {
  currentStep = n;
  render();
  window.scrollTo({top:0, behavior:'smooth'});
}

function attachEvents() {}

// INIT
render();
</script>
</body>
</html>
